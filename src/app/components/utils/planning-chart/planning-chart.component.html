


<div class="container-fluid justify-content-center align-items-center">
  
<h1 class="text-center display-1">Planning Chart</h1>

<div class="overflow-auto flex-column position-relative bg-white rounded shadow mt-4 booking-chart-container">
  <!-- <div class="overlay-div"></div> -->
  <table class="table table-bordered">
    <!-- <div #scrollSentinelPrev observeVisibility (visible)="loadPreviousMonth()"></div> -->
    <thead class="sticky-top">
      <tr class="bg-white z-index-10">
        <th class="room-name-title" rowspan="3">Room ID</th>
        <ng-container *ngFor="let month of months">
          <th [attr.colspan]="month.days.length" class="text-center align-middle bg-dark-subtle">
            {{ month.month | date : "MMMM yyyy" }}
          </th>
        </ng-container>
      </tr>
      <tr>
        <ng-container *ngFor="let month of months">
          <ng-container *ngFor="let day of month.days; let last = last">
            <th *ngIf="!last" class="date-cell text-dark">{{ day | date : "dd" }}</th>
            <th *ngIf="last" class="date-cell text-dark">{{ day | date : "dd" }}</th>
          </ng-container>
        </ng-container>
      </tr>
      <tr>
        <ng-container *ngFor="let month of months">
          <ng-container *ngFor="let day of month.days; let last = last">
            <th *ngIf="!last" class="date-cell text-dark">{{ day | date : "EEE" }}</th>
            <th *ngIf="last" class="date-cell text-dark">{{ day | date : "EEE" }}</th>
          </ng-container>
        </ng-container>
        <div #scrollSentinelNext observeVisibility (visible)="loadNextMonth()"></div>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let room of rooms">
        <td class="room-name"
        >{{ room.roomId }}.{{room.roomName}}</td>
        <ng-container *ngFor="let month of months">
          <ng-container *ngFor="let day of month.days">
            <td
              class="booking-cell"
              [ngClass]="{
                'selected': isSelected(room.roomId, day),
                'start-of-reservation': isStartOfReservation(room.roomId, day),
                'middle-of-reservation': isMiddleOfReservation(room.roomId, day),
                'end-of-reservation': isEndOfReservation(room.roomId, day),
                'cursor-disabled': isNotAvailable(room.roomId, day),
                'arrival-cell': isArrivalCell(room.roomId, day),
                'departure-cell': isDepartureCell(room.roomId, day)
              }"
              [attr.title]="isStartOfReservation(room.roomId, day) || isMiddleOfReservation(room.roomId, day) || isEndOfReservation(room.roomId, day) ? getTooltipText(room.roomId, day) : null"
              (mousedown)="onMouseDown(room.roomId, day, $event)"
              (mouseover)="onMouseOver(room.roomId, day, $event)"
              (mousemove)="onMouseMove(room.roomId, day, $event)"
              (mouseup)="onMouseUp(room.roomId,day,$event)"
              (mouseout)="onMouseOut()"
            >
            <span
            *ngIf="isStartOfReservation(room.roomId, day)"
            class="reservation-marker"
            [ngStyle]="{ width: getReservationWidth(room.roomId, day) }"
          >
          </span></td>
          </ng-container>
        </ng-container>
      </tr>
    </tbody>
  </table>
</div>

</div>
